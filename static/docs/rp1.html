<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>RP(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">RP(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">RP(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">rp</code> &#x2014; <span class="Nd">high-level
    interface to rosenpass</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><code class="Nm">rp</code></td>
    <td>[<var class="Ar">explain</var>] [<var class="Ar">verbose</var>]
      <var class="Ar">genkey</var> <var class="Ar">...</var> |
      <var class="Ar">pubkey ...</var> | <var class="Ar">exchange ...</var></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">rp</code></td>
    <td>[...] <var class="Ar">genkey PRIVATE_KEYS_DIR</var></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">rp</code></td>
    <td>[...] <var class="Ar">pubkey</var>
      <var class="Ar">PRIVATE_KEYS_DIR</var>
      <var class="Ar">PUBLIC_KEYS_DIR</var></td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">rp</code></td>
    <td>[...] <var class="Ar">exchange</var>
      <var class="Ar">PRIVATE_KEYS_DIR</var> [dev &lt;device&gt;] [listen
      &lt;ip&gt;:&lt;port&gt;] [peer PUBLIC_KEYS_DIR [endpoint
      &lt;ip&gt;:&lt;port&gt;] [persistent-keepalive &lt;interval&gt;]
      [allowed-ips &lt;ip1&gt;/&lt;cidr1&gt;[,&lt;ip2&gt;/&lt;cidr2&gt;] ...]]
      ...</td>
  </tr>
</table>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">The <code class="Nm">rp</code> program is used to build a VPN with
    WireGuard and Rosenpass.</p>
<p class="Pp">The optional [explain] and [verbose] options can be used to obtain
    further help or to enable a detailed view on the operations,
  respectively.</p>
<section class="Ss">
<h2 class="Ss" id="COMMANDS"><a class="permalink" href="#COMMANDS">COMMANDS</a></h2>
<dl class="Bl-tag">
  <dt><var class="Ar">genkey</var> <var class="Ar">PRIVATE_KEYS_DIR</var></dt>
  <dd>Creates a new directory with appropriate permissions and generates all the
      necessary private keys required for a peer to participate in a rosenpass
      connection.</dd>
  <dt><var class="Ar">pubkey</var> <var class="Ar">PRIVATE_KEYS_DIR</var>
    <var class="Ar">PUBLIC_KEYS_DIR</var></dt>
  <dd>Creates a fresh directory at <var class="Ar">PUBLIC_KEYS_DIR</var>, which
      contains the extracted public keys from the private keys generated by
      <var class="Ar">genkey</var> and located inside
      <var class="Ar">PRIVATE_KEYS_DIR</var>.</dd>
  <dt><var class="Ar">exchange</var> <var class="Ar">PRIVATE_KEYS_DIR [dev
    &lt;device&gt;] [listen &lt;ip&gt;:&lt;port&gt;] [PEERS]</var></dt>
  <dd>Starts the VPN on interface <var class="Ar">device</var>, listening on the
      provided IP and port combination, allowing connections from
      <var class="Ar">PEERS</var>.</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="EXIT_STATUS"><a class="permalink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
<p class="Pp">The <code class="Nm">rp</code> utility exits&#x00A0;0 on success,
    and&#x00A0;&gt;0 if an error occurs.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<p class="Pp">In this example, we will assume that the server has an interface
    bound to 192.168.0.1, that accepts incoming connections on port 9999/UDP for
    Rosenpass and port 10000/UDP for WireGuard.</p>
<p class="Pp">To create a VPN connection, start by generating secret keys on
    both hosts.</p>
<div class="Bd Pp Bd-indent Li">
<pre>rp genkey server.rosenpass-secret
rp genkey client.rosenpass-secret</pre>
</div>
<p class="Pp">Extract the public keys:</p>
<div class="Bd Pp Bd-indent Li">
<pre>rp pubkey server.rosenpass-secret server.rosenpass-public
rp pubkey client.rosenpass-secret client.rosenpass-public</pre>
</div>
<p class="Pp">Copy the &quot;-public&quot; directories to the other peers and
    then start the VPN. On the server:</p>
<div class="Bd Pp Bd-indent Li">
<pre>sudo rp exchange server.rosenpass-secret dev rosenpass0 listen 192.168.0.1:9999 \
    peer client.rosenpass-public allowed-ips fe80::/64</pre>
</div>
<p class="Pp">On the client:</p>
<div class="Bd Pp Bd-indent Li">
<pre>sudo rp exchange client.rosenpass-secret dev rosenpass 0 \
    peer server.rosenpass-public endpoint 192.168.0.1:9999 allowed-ips fe80::/64</pre>
</div>
<p class="Pp">Assign IP addresses:</p>
<div class="Bd Pp Bd-indent Li">
<pre>sudo ip a add fe80::1/64 dev rosenpass0 # Server
sudo ip a add fe80::2/64 dev rosenpass0 # Client</pre>
</div>
<p class="Pp">Test the connection by pinging the server on the client
  machine:</p>
<div class="Bd Pp Bd-indent Li">
<pre>ping fe80::1%rosenpass0 # Client</pre>
</div>
<p class="Pp">You can watch how rosenpass replaces the WireGuard PSK with the
    following:</p>
<div class="Bd Pp Bd-indent Li">
<pre>watch -n 0.2 'wg show all; wg show all preshared-keys'</pre>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr">rosenpass(1)</a>, <a class="Xr">wg(1)</a></p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
<p class="Pp">Rosenpass was created by Karolin Varner, Benjamin Lipp, Wanja
    Zaeske, Marei Peischl, Stephan Ajuvo, and Lisa Schmidt.</p>
<p class="Pp">This manual page was written by <span class="An">Clara
    Engler</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
<p class="Pp">The bugs are tracked at
    <a class="Lk" href="https://github.com/rosenpass/rosenpass/issues">https://github.com/rosenpass/rosenpass/issues</a>.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">September 16, 2024</td>
    <td class="foot-os">Debian</td>
  </tr>
</table>
</body>
</html>
